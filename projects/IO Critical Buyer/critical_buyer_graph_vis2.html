<html>
  <head>
    <style>
      body {
        font-family: "Helvetica", sans-serif;
        padding-left: 20px;
        padding-top: 20px;
      }
    </style>
    <title>IO Table Visualisation</title>
    <script src="https://vega.github.io/vega-editor/vendor/d3.min.js"></script>
    <script src="https://vega.github.io/vega-editor/vendor/d3.geo.projection.min.js"></script>
    <script src="https://vega.github.io/vega-editor/vendor/topojson.js"></script>
    <script src="https://vega.github.io/vega-editor/vendor/d3.layout.cloud.js"></script>
    <script src="http://vega.github.io/vega-editor/vendor/vega.js" charset="utf-8"></script>
    <script src="http://vega.github.io/vega-editor/vendor/vega-embed.js" charset="utf-8"></script>
  </head>
  <body>
    <h1>Input-Output Table Visualisation: Critical Buyers</h1>

    <p>Each node in the visualisations below represents one of the 127 sectors of the Singapore economy.</p>
    <ul>
      <li>The size of the node represents its total output (includes exports and final domestic demand).</li>
      <li>The colour of the node represents the cluster it belongs to.</li>
    </ul>

    <p>The links depict "critical buyer" relationships: a link is drawn from A to B (follow the arcs in a clockwise manner) if B is a critical buyer of A.</p>
    <ul>
      <li>The thicker the link (from A to B), the larger the percentage of A's output purchased by B.</li>
    </ul>

    <p>This visualisation is mildly interactive. You can:</p>
    <ul>
      <li>Hover over a node to see its description,</li>
      <li>Double-click a node to see its total demand and linkages. Orange links go to sectors which the node is a critical buyer of, while blue links go to sectors which are critical buyers of the node.</li>
      <li>Hover over a link to see the buyer and supplier in the relationship, as well as the percentage of the supplier's output going to the buyer.</li>
    </ul>

    <p>Due to software limitations, I was not able to draw links from a sector to itself.</p>

    <h2>Notes for this version</h2>
    <p>Links only appear when a node is double-clicked. A link from A to B is only drawn if B is one of A's top 5 buyers and B buys more than 10% of A's output. Exports and Domestic Demand are included as nodes.</p>
    <div id="vis"></div>

    <h2>Legend 1</h2>
    <div id="legendVis1"></div>

    <h2>Legend 2</h2>
    <div id="legendVis2"></div>


  </body>
<script type="text/javascript">

// parse a spec and create a visualization view
function parse(spec, id) {
  vg.parse.spec(spec, function(error, chart) { chart({el: id}).update(); });
}

//parse("vega_graph_critical_buyer v9.json", "#vis");
//parse("vega_graph_critical_buyer_legendVis1.json", "#legendVis1");
//parse("vega_graph_critical_buyer_legendVis2.json", "#legendVis2");

vg.embed('#vis', "vega_graph_critical_buyer v9.json");
vg.embed('#legendVis1', "vega_graph_critical_buyer_legendVis1.json");
vg.embed('#legendVis2', "vega_graph_critical_buyer_legendVis2.json");

</script>
</html>
